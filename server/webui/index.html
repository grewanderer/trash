<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <title>WISP Dev UI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header>
  <h1>WISP Dev UI</h1>
  <div class="status">
    <button id="btn-health">Health</button>
    <span id="health-result" class="muted">—</span>
    <button id="btn-ready">Ready</button>
    <span id="ready-result" class="muted">—</span>
  </div>
</header>

<section>
  <h2>Настройки (локально, без сервера)</h2>
  <div class="grid">
    <label>Base URL
      <input id="baseUrl" placeholder="http://localhost:8080"/>
    </label>
    <label>Shared Secret
      <input id="secret" placeholder="controller secret"/>
    </label>
    <label>Device UUID
      <input id="uuid" placeholder="auto-filled after register"/>
    </label>
    <label>Device Key
      <input id="key" placeholder="auto-filled after register"/>
    </label>
  </div>
  <div class="row">
    <button id="save-settings">Сохранить</button>
    <span class="muted">Хранится в localStorage</span>
  </div>
</section>

<section>
  <h2>Device: регистрация / checksum / download / debug / report</h2>
  <div class="grid">
    <label>Hostname <input id="dev-hostname" placeholder="my-openwrt"/></label>
    <label>Backend  <input id="dev-backend"  placeholder="openwrt"/></label>
    <label>MAC      <input id="dev-mac"      placeholder="aa:bb:cc:dd:ee:ff"/></label>
  </div>
  <div class="row">
    <button id="btn-register">Register</button>
    <button id="btn-checksum">Checksum</button>
    <button id="btn-download">Download config</button>
    <button id="btn-debug">Debug-config</button>
    <button id="btn-report-ok">Report status (applied)</button>
  </div>
  <pre id="device-log" class="log"></pre>
</section>

<section>
  <h2>Templates</h2>
  <details open>
    <summary>Создать шаблон</summary>
    <div class="grid">
      <label>Name <input id="tpl-name" placeholder="system-hostname"/></label>
      <label>Path <input id="tpl-path" placeholder="etc/config/system (для type=go)"/></label>
      <label>Type
        <select id="tpl-type">
          <option value="go">go</option>
          <option value="netjson">netjson</option>
        </select>
      </label>
      <label><input type="checkbox" id="tpl-required"> required</label>
      <label><input type="checkbox" id="tpl-default"> default</label>
    </div>
    <label>Body</label>
    <textarea id="tpl-body" rows="10" placeholder="go-template или NetJSON"></textarea>
    <div class="row">
      <button id="btn-tpl-create">Create</button>
    </div>
  </details>

  <div class="row">
    <button id="btn-tpl-list">List templates</button>
  </div>
  <table id="tpl-table">
    <thead><tr><th>ID</th><th>Name</th><th>Type</th><th>Required</th><th>Default</th><th>Path</th><th>Actions</th></tr></thead>
    <tbody></tbody>
  </table>
</section>

<section>
  <h2>Device Vars / Group Vars</h2>
  <div class="grid">
    <label>Var key <input id="var-key" placeholder="hostname"/></label>
    <label>Var value <input id="var-value" placeholder="branch-ap-01"/></label>
  </div>
  <div class="row">
    <button id="btn-dev-var-upsert">Upsert device var</button>
    <button id="btn-dev-vars-list">Get device vars</button>
  </div>
  <pre id="vars-log" class="log"></pre>

  <hr/>
  <div class="grid">
    <label>Group name <input id="group-name" placeholder="branch-a"/></label>
  </div>
  <div class="row">
    <button id="btn-group-create">Create group</button>
    <button id="btn-group-list">List device groups</button>
  </div>
  <div class="grid">
    <label>Group ID <input id="group-id" placeholder="1"/></label>
  </div>
  <div class="row">
    <button id="btn-join-group">Join device to group</button>
  </div>

  <div class="grid">
    <label>Group var key <input id="gvar-key" placeholder="timezone"/></label>
    <label>Group var value <input id="gvar-value" placeholder="Europe/Rome"/></label>
  </div>
  <div class="row">
    <button id="btn-group-var-upsert">Upsert group var</button>
  </div>
</section>

<section>
  <h2>Group Templates / Assignments</h2>
  <div class="grid">
    <label>Group ID <input id="agt-group-id" placeholder="1"/></label>
    <label>Template ID <input id="agt-tpl-id" placeholder="2"/></label>
    <label>Order <input id="agt-order" placeholder="100"/></label>
    <label>Enabled <select id="agt-enabled"><option value="true">true</option><option value="false">false</option></select></label>
  </div>
  <div class="row">
    <button id="btn-assign-tpl-group">Assign template to group</button>
  </div>

  <div class="grid">
    <label>Template ID <input id="block-tpl-id" placeholder="2"/></label>
  </div>
  <div class="row">
    <button id="btn-block-tpl">Block on device</button>
    <button id="btn-unblock-tpl">Unblock on device</button>
  </div>

  <div class="row">
    <button id="btn-device-assign-tpl-list">List device assignments</button>
    <button id="btn-resolved-templates">Resolved templates (order)</button>
  </div>
  <pre id="assign-log" class="log"></pre>
</section>

<section>
  <h2>IPAM</h2>
  <div class="grid">
    <label>Group ID <input id="ipam-group-id" placeholder="1"/></label>
    <label>CIDR <input id="ipam-cidr" placeholder="10.100.0.0/24"/></label>
  </div>
  <div class="row">
    <button id="btn-group-prefix-add">Add group prefix</button>
  </div>
  <div class="row">
    <button id="btn-alloc-ip">Allocate IP for device</button>
  </div>
  <pre id="ipam-log" class="log"></pre>
</section>

<section>
  <h2>Debug Build (preview)</h2>
  <div class="row">
    <button id="btn-debug-build">Fetch debug-config JSON</button>
  </div>
  <pre id="debug-log" class="log"></pre>
</section>

<footer>
  <span class="muted">WISP Dev UI — for local testing</span>
</footer>

<script src="app.js"></script>
</body>
</html>
